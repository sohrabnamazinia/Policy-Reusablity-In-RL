Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
/Users/omidvart/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/patch_gym.py:49: UserWarning: You provided an OpenAI Gym environment. We strongly recommend transitioning to Gymnasium environments. Stable-Baselines3 is automatically wrapping your environments in a compatibility layer, which could potentially cause issues.
  warnings.warn(
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 162      |
|    ep_rew_mean      | 160      |
|    exploration_rate | 0.386    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 5921     |
|    time_elapsed     | 0        |
|    total_timesteps  | 646      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 121      |
|    ep_rew_mean      | 120      |
|    exploration_rate | 0.0832   |
| time/               |          |
|    episodes         | 8        |
|    fps              | 5655     |
|    time_elapsed     | 0        |
|    total_timesteps  | 965      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 111      |
|    ep_rew_mean      | 110      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 12       |
|    fps              | 5735     |
|    time_elapsed     | 0        |
|    total_timesteps  | 1336     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 110      |
|    ep_rew_mean      | 109      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 16       |
|    fps              | 5764     |
|    time_elapsed     | 0        |
|    total_timesteps  | 1761     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 107      |
|    ep_rew_mean      | 106      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 20       |
|    fps              | 5787     |
|    time_elapsed     | 0        |
|    total_timesteps  | 2149     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 90       |
|    ep_rew_mean      | 89.1     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 24       |
|    fps              | 5782     |
|    time_elapsed     | 0        |
|    total_timesteps  | 2161     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 80       |
|    ep_rew_mean      | 79.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 28       |
|    fps              | 5780     |
|    time_elapsed     | 0        |
|    total_timesteps  | 2239     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 77.8     |
|    ep_rew_mean      | 77.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 32       |
|    fps              | 5768     |
|    time_elapsed     | 0        |
|    total_timesteps  | 2491     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 80.1     |
|    ep_rew_mean      | 79.5     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 36       |
|    fps              | 5768     |
|    time_elapsed     | 0        |
|    total_timesteps  | 2883     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 98.8     |
|    ep_rew_mean      | 96.8     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 40       |
|    fps              | 5815     |
|    time_elapsed     | 0        |
|    total_timesteps  | 3952     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 108      |
|    ep_rew_mean      | 107      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 44       |
|    fps              | 5841     |
|    time_elapsed     | 0        |
|    total_timesteps  | 4771     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 102      |
|    ep_rew_mean      | 101      |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 48       |
|    fps              | 5836     |
|    time_elapsed     | 0        |
|    total_timesteps  | 4912     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 99.8     |
|    ep_rew_mean      | 98.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 52       |
|    fps              | 5837     |
|    time_elapsed     | 0        |
|    total_timesteps  | 5190     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 96.4     |
|    ep_rew_mean      | 95       |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 56       |
|    fps              | 5842     |
|    time_elapsed     | 0        |
|    total_timesteps  | 5401     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 97.2     |
|    ep_rew_mean      | 95.9     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 60       |
|    fps              | 5851     |
|    time_elapsed     | 0        |
|    total_timesteps  | 5834     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 93.2     |
|    ep_rew_mean      | 92       |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 64       |
|    fps              | 5852     |
|    time_elapsed     | 1        |
|    total_timesteps  | 5968     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 95.8     |
|    ep_rew_mean      | 94.1     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 68       |
|    fps              | 5847     |
|    time_elapsed     | 1        |
|    total_timesteps  | 6511     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 91.7     |
|    ep_rew_mean      | 90.1     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 72       |
|    fps              | 5844     |
|    time_elapsed     | 1        |
|    total_timesteps  | 6599     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 89.9     |
|    ep_rew_mean      | 88.4     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 76       |
|    fps              | 5842     |
|    time_elapsed     | 1        |
|    total_timesteps  | 6836     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 88.1     |
|    ep_rew_mean      | 86.7     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 80       |
|    fps              | 5841     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7047     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 84.7     |
|    ep_rew_mean      | 83.4     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 84       |
|    fps              | 5838     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7116     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 83.9     |
|    ep_rew_mean      | 82.6     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 88       |
|    fps              | 5844     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7379     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 82.9     |
|    ep_rew_mean      | 81.7     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 92       |
|    fps              | 5852     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7626     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 79.7     |
|    ep_rew_mean      | 78.5     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 96       |
|    fps              | 5851     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7650     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 88.1     |
|    ep_rew_mean      | 86.4     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 100      |
|    fps              | 5887     |
|    time_elapsed     | 1        |
|    total_timesteps  | 8810     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 86.1     |
|    ep_rew_mean      | 84.5     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 104      |
|    fps              | 5899     |
|    time_elapsed     | 1        |
|    total_timesteps  | 9260     |
----------------------------------
Traceback (most recent call last):
  File "/Users/omidvart/Desktop/Amazon/RL-Modular/train_deep_policy.py", line 36, in <module>
    q_agent = QLearningAgent(n_states=np.product(grid_world.grid.shape), n_actions=len(grid_world.action_space))
NameError: name 'np' is not defined