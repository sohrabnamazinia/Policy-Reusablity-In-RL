Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.
/Users/omidvart/Library/Python/3.9/lib/python/site-packages/stable_baselines3/common/vec_env/patch_gym.py:49: UserWarning: You provided an OpenAI Gym environment. We strongly recommend transitioning to Gymnasium environments. Stable-Baselines3 is automatically wrapping your environments in a compatibility layer, which could potentially cause issues.
  warnings.warn(
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 137      |
|    ep_rew_mean      | 97.8     |
|    exploration_rate | 0.478    |
| time/               |          |
|    episodes         | 4        |
|    fps              | 5881     |
|    time_elapsed     | 0        |
|    total_timesteps  | 549      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 84.6     |
|    ep_rew_mean      | 64.9     |
|    exploration_rate | 0.357    |
| time/               |          |
|    episodes         | 8        |
|    fps              | 5525     |
|    time_elapsed     | 0        |
|    total_timesteps  | 677      |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 108      |
|    ep_rew_mean      | 73.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 12       |
|    fps              | 5695     |
|    time_elapsed     | 0        |
|    total_timesteps  | 1299     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 92.8     |
|    ep_rew_mean      | 63.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 16       |
|    fps              | 5734     |
|    time_elapsed     | 0        |
|    total_timesteps  | 1485     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 92       |
|    ep_rew_mean      | 59.1     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 20       |
|    fps              | 5783     |
|    time_elapsed     | 0        |
|    total_timesteps  | 1841     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 77.8     |
|    ep_rew_mean      | 50.4     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 24       |
|    fps              | 5782     |
|    time_elapsed     | 0        |
|    total_timesteps  | 1867     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 67.8     |
|    ep_rew_mean      | 44.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 28       |
|    fps              | 5781     |
|    time_elapsed     | 0        |
|    total_timesteps  | 1897     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 70.7     |
|    ep_rew_mean      | 44.3     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 32       |
|    fps              | 5815     |
|    time_elapsed     | 0        |
|    total_timesteps  | 2262     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 72.3     |
|    ep_rew_mean      | 46       |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 36       |
|    fps              | 5831     |
|    time_elapsed     | 0        |
|    total_timesteps  | 2602     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 81.6     |
|    ep_rew_mean      | 52       |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 40       |
|    fps              | 5860     |
|    time_elapsed     | 0        |
|    total_timesteps  | 3264     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 83.7     |
|    ep_rew_mean      | 53.9     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 44       |
|    fps              | 5840     |
|    time_elapsed     | 0        |
|    total_timesteps  | 3682     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 94.1     |
|    ep_rew_mean      | 60.5     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 48       |
|    fps              | 5855     |
|    time_elapsed     | 0        |
|    total_timesteps  | 4517     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 87.4     |
|    ep_rew_mean      | 56.4     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 52       |
|    fps              | 5854     |
|    time_elapsed     | 0        |
|    total_timesteps  | 4545     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 90.5     |
|    ep_rew_mean      | 60       |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 56       |
|    fps              | 5857     |
|    time_elapsed     | 0        |
|    total_timesteps  | 5068     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 88.8     |
|    ep_rew_mean      | 60.1     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 60       |
|    fps              | 5851     |
|    time_elapsed     | 0        |
|    total_timesteps  | 5327     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 88.1     |
|    ep_rew_mean      | 59.9     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 64       |
|    fps              | 5851     |
|    time_elapsed     | 0        |
|    total_timesteps  | 5640     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 85.7     |
|    ep_rew_mean      | 59.1     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 68       |
|    fps              | 5852     |
|    time_elapsed     | 0        |
|    total_timesteps  | 5825     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 89.5     |
|    ep_rew_mean      | 61.9     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 72       |
|    fps              | 5847     |
|    time_elapsed     | 1        |
|    total_timesteps  | 6446     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 89.2     |
|    ep_rew_mean      | 61.3     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 76       |
|    fps              | 5845     |
|    time_elapsed     | 1        |
|    total_timesteps  | 6778     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 89       |
|    ep_rew_mean      | 61       |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 80       |
|    fps              | 5846     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7118     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 86.6     |
|    ep_rew_mean      | 59.9     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 84       |
|    fps              | 5848     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7271     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 86.3     |
|    ep_rew_mean      | 59.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 88       |
|    fps              | 5858     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7592     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 85.4     |
|    ep_rew_mean      | 58.4     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 92       |
|    fps              | 5866     |
|    time_elapsed     | 1        |
|    total_timesteps  | 7859     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 86.5     |
|    ep_rew_mean      | 59.6     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 96       |
|    fps              | 5869     |
|    time_elapsed     | 1        |
|    total_timesteps  | 8300     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 89.9     |
|    ep_rew_mean      | 62.1     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 100      |
|    fps              | 5881     |
|    time_elapsed     | 1        |
|    total_timesteps  | 8990     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 88.7     |
|    ep_rew_mean      | 61.2     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 104      |
|    fps              | 5895     |
|    time_elapsed     | 1        |
|    total_timesteps  | 9419     |
----------------------------------
----------------------------------
| rollout/            |          |
|    ep_len_mean      | 92.8     |
|    ep_rew_mean      | 64.7     |
|    exploration_rate | 0.05     |
| time/               |          |
|    episodes         | 108      |
|    fps              | 5909     |
|    time_elapsed     | 1        |
|    total_timesteps  | 9955     |
----------------------------------
Traceback (most recent call last):
  File "/Users/omidvart/Desktop/Amazon/RL-Modular/train_deep_policy.py", line 35, in <module>
    q_agent = QLearningAgent(n_states=np.product(grid_world.grid.shape), n_actions=len(grid_world.action_space))
NameError: name 'QLearningAgent' is not defined