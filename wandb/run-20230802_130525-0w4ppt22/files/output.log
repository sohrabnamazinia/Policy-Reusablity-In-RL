/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/common/vec_env/patch_gym.py:49: UserWarning: You provided an OpenAI Gym environment. We strongly recommend transitioning to Gymnasium environments. Stable-Baselines3 is automatically wrapping your environments in a compatibility layer, which could potentially cause issues.
  warnings.warn(
Traceback (most recent call last):
  File "/Users/sohrabnamazinia/Desktop/Summer 23/RA/RL/RL_Modular/train_deep_policy.py", line 34, in <module>
    deep_agent = Agent(grid_world, deep_algorithm)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/sohrabnamazinia/Desktop/Summer 23/RA/RL/RL_Modular/agents/deep_agent.py", line 25, in __init__
    self.model = DQN("CnnPolicy", env, verbose=1)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/dqn/dqn.py", line 141, in __init__
    self._setup_model()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/dqn/dqn.py", line 144, in _setup_model
    super()._setup_model()
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/common/off_policy_algorithm.py", line 199, in _setup_model
    self.policy = self.policy_class(  # pytype:disable=not-instantiable
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/dqn/policies.py", line 248, in __init__
    super().__init__(
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/dqn/policies.py", line 151, in __init__
    self._build(lr_schedule)
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/dqn/policies.py", line 163, in _build
    self.q_net = self.make_q_net()
                 ^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/dqn/policies.py", line 177, in make_q_net
    net_args = self._update_features_extractor(self.net_args, features_extractor=None)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/common/policies.py", line 114, in _update_features_extractor
    features_extractor = self.make_features_extractor()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/common/policies.py", line 120, in make_features_extractor
    return self.features_extractor_class(self.observation_space, **self.features_extractor_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.11/lib/python3.11/site-packages/stable_baselines3/common/torch_layers.py", line 77, in __init__
    assert is_image_space(observation_space, check_channels=False, normalized_image=normalized_image), (
AssertionError: You should use NatureCNN only with images not with Box(-1.0, 10.0, (5, 6), float32)
(you are probably using `CnnPolicy` instead of `MlpPolicy` or `MultiInputPolicy`)
If you are using a custom environment,
please check it using our env checker:
https://stable-baselines3.readthedocs.io/en/master/common/env_checker.html.
If you are using `VecNormalize` or already normalized channel-first images you should pass `normalize_images=False`:
https://stable-baselines3.readthedocs.io/en/master/guide/custom_env.html
Using cpu device
Wrapping the env with a `Monitor` wrapper
Wrapping the env in a DummyVecEnv.